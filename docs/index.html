<!DOCTYPE HTML>
<!--
    Stellar by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">
    <head>
        <title>BaleBot</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="stylesheet" href="assets/css/main.css" />
        <link rel="stylesheet" href="assets/css/custom.css" />
        <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
        <link rel="shortcut icon" type="image/png" href="images/Seal_of_University_of_California,_Berkeley.png"/>
    </head>
    <body class="is-preload">

        <!-- Wrapper -->
        <div id="wrapper">
            <!-- Header -->
            <header id="header" class="alt">
                <h1>BaleBot</h1>
                <h2>Collaborative Trajectory Tracking and Multi-Robot Control</h2>
                

                <iframe class="youtube"
                        width="850"
                        height="478"
                        src="https://www.youtube.com/embed/kbM0s6gdCPo"
                        frameborder="0"
                        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                </iframe>

                <h3><a href="https://github.com/TheYoshiStory/EECS206A">Source</a></h3>
                <p> 
                    <a href="https://www.linkedin.com/in/ayusmansaha">Ayusman Saha</a> |
                    <a href="https://www.linkedin.com/in/leotoulet">Léo Toulet</a> |
                    <a href="https://fdesousa.fr">Philippe Ferreira De Sousa</a> | 
                    Tarun Singh |Joshua Lin
                </p>
            </header>

            <!-- Nav -->
            <nav id="nav">
                <ul>
                    <li><a href="#overview" class="active">Overview</a></li>
                    <li><a href="#design">Design</a></li>
                    <li><a href="#implementation">Implementation</a></li>
                    <li><a href="#improvements">Improvements</a></li>
                    <li><a href="#team">Team</a></li>
                </ul>
            </nav>

            <!-- Main -->
            <div id="main">
                <!-- Overview -->
                <section id="overview" class="main">
                    <div class="spotlight">
                        <div class="content">
                            <header class="major">
                                <h2>Introduction</h2>
                            </header>
                            <p style="text-align: justify;">
                                BaleBot coordinates multiple TurtleBot2 robots to function as a single
                                entity. It achieves this by maintaining a rigid body structure as it
                                tracks a trajectory from an initial state to a final state.This is an
                                interesting problem because the system is nonlinear and nonholonomic.
                                Dynamics need to be taken into account when planning and control loops
                                need to be synchronized between all agents. The main application for
                                this project would be in warehouse robotics. It can enable several
                                smaller robots to move large objects by working collaboratively.
                            </p>
                        </div>
                        <span class="image"><img src="images/system.jpg" alt=""/></span>
                    </div>
                </section>

                <!-- Design -->
                <section id="design" class="main">
                    <div class="spotlight">
                        <div class="content">
                            <header class="major">
                                <h2>Design</h2>
                            </header>
                            <p style="text-align: justify;">
                                The project was broken into 3 distinct subproblems: sensing, planning,
                                and control. Sensing had to create reasonable state estimates of all
                                robots with respect to the goal position, planning had to generate a
                                valid trajectory from the starting point to the goal, and control had
                                to track the trajectory point-by-point.
                                <br/>
                                <br/>
                                To make state estimation as accurate as possible, we utilize an external
                                camera with AR tags to determine position and orientation of each robot.
                                Although this provides a direct measurement of the state, it limits the
                                workspace of the system to the camera's field-of-view and is prone to
                                high-frequency noise as the robots move further away from the camera.
                                <br/>
                                <br/>
                                Planning had to take into consideration the system model when generating
                                a path. The primary requirement was that the derivative of trajectory had
                                to be continuous. This would enable nonholonomic systems to track the
                                trajectory without instantaneous rotational or horizontal motion. An
                                <a href="https://www.yumpu.com/en/document/view/8662921/robotics-1-wheeled-mobile-robots-analysis-planning-and-control">algorithm</a>
                                presented by Professor Alessandro De Luca from the Sapienza University
                                of Rome was utilized for its simplicity and flexibility.
                            </p>
                            <img style="width:75%;" src="images/trajectory_croppped.png"/>
                            <p style="text-align: justify;">
                                <br/>
                                Control had to drive the system to the next state while maintaining its
                                rigid body structure. To achieve this, we designed a hierarchical structure
                                that consists of a single global controller and multiple local controllers.
                                The global controller would generate control signals for the global robot
                                which would then be fed as an input to the local controllers. The local
                                controllers utilize this to determine a feedforward signal that is used
                                in conjunction with a proportional controller to derive the control signals
                                for each robot.
                            </p>
                            <img style="width:75%;" src="images/RotatingBody_cropped.png"/>
                            <p style="text-align: justify;">
                                <br/>
                                The major tradeoff in the design was maintaining the rigid body structure
                                at the controls level rather than the planning level. Although this allows
                                the system to maintain its structure very accurately, it limits the robot
                                configurations such that the global robot can still be described by a
                                unicycle-model. The alternative would be to generate a path for the global
                                robot and then translate it for each local robot. This would permit arbitrary
                                robot configurations at the cost of a less reliable rigid body structure.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Implementation -->
                <section id="implementation" class="main">
                    <div class="spotlight">
                        <div class="content">
                            <header class="major">
                                <h2>Implementation</h2>
                            </header>
                            <p style="text-align: justify;">
                                The project was implemented in ROS Kinetic and tested with three TurtleBot2 robots.
                                The only external packages used were <code>ar_track_alvar`</code> for AR tracking and
                                <code>usb_cam</code> as a driver for the Logitech C922x camera.
                            </p>
                            <div style="display: flex; justify-content: center">
                                <img style="width:75%;" src="images/PBDcode_cropped.png"/>
                            </div>
                            <p style="text-align: justify;">
                                <br/>
                                To make communication simple, we created a custom message type defined in <code>msg/State.msg</code>.
                                It comprises of a float tuple (x, y, θ) that is used to fully describe the state-space.
                                <br/>
                                <br/>
                                <code>src/frame_publisher.py</code> is a node that is used to update the goal frame in the case
                                it is obstructed from view. <code>src/state_observer.py</code> determines the state estimate of
                                all robots with respect the the goal frame. It utilizes TF transformations and performs a rolling
                                average before converting to a State message. <code>src/path_planner.py</code> gets the initial
                                state of the global robot and calculates a trajectory with respect to the goal frame. It then
                                samples this path to create State waypoints for the control node to follow. It continuously monitors
                                the state of the global robot to determine when to publish the next waypoint. <code>src/motion_controller.py</code>
                                runs the global and local controllers. The global controller uses a proportional-integral controller
                                to derive control signals based on the next waypoint published by the planner along with the current
                                state of the global robot. The local controller then interprets these commands as a feedforward term
                                for a proportional controller that corrects for the state error between where the local robot
                                currently is and where it should be with respect to the global robot.
                                <br/>
                                <br/>
                                There are also several launch files to simplify execution. <code>launch/rviz.launch</code> starts
                                RVIZ along with the AR tracker and camera driver. <code>launch/robot.launch</code> is used to run
                                the system on hardware while <code>launch/simulator.launch</code> is used to run the system in
                                simulation. These files also contain settings such as global robot configuration, AR marker
                                numbers and command topics.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Results -->
                <section id="results" class="main">
                    <div class="spotlight">
                        <div class="content">
                            <header class="major">
                                <h2>Results</h2>
                            </header>
                            <p style="text-align: justify;">
                                Overall, the project met our most important design criteria of maintaining a rigid body
                                structure while in motion. It was able to move between states in an obstacle-free
                                environment provided all robots remained in the camera’s field-of-view.
                                <br/>
                                <br/>
                                The global controller was relatively robust provided it did not miss a waypoint in
                                the path. This was prevented by appropriately selecting the distance between
                                waypoints and the curvature of the trajectory. The system was able to reach its
                                targets within 10cm and 5°.
                                <br/>
                                <br/>
                                The local controllers were robust to disturbances in initial conditions as well
                                as deviations from the global robot. They maintained their states within 5cm of
                                translational error and 5° of rotational error.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Improvements -->
                <section id="improvements" class="main">
                    <div class="spotlight">
                        <div class="content">
                            <header class="major">
                                <h2>Improvements</h2>
                            </header>
                            <p style="text-align: justify;">
                                Currently, robot configurations are limited. All configurations must have a
                                robot located at the origin of the global robot and the local robots can only
                                be placed along the horizontal axis. For arbitrary configurations to be possible,
                                state estimation of the global frame needs to be achieved with reasonable
                                accuracy using only the state estimations of the local frames. In order to
                                place robots away from the horizontal axis, the controller has to be redesigned
                                since the overall system changes from a unicycle-model robot to a bicycle model robot.
                                <br/>
                                <br/>
                                Another addition would be the use of onboard sensors to improve state estimation
                                and enable obstacle avoidance. State estimation is done primarily through an
                                external camera and AR tags in key locations. However, combining this with odometry
                                using a complementary filter would reduce sensor noise and generate a better state
                                estimate. The TurtleBot2 platform also have depth cameras, allowing them to perform
                                SLAM. This can be used to detect nearby obstacles and recompute the trajectory if
                                it becomes unobtainable.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Team -->
                <section id="team" class="main special">
                    <header class="major">
                        <h2>Team</h2>
                        <iframe width="100%"
                                height="480px"
                                frameborder="0"
                                src="./carousel.html"></iframe>
                    </header>
                </section>
            </div>

            <!-- Footer -->
            <footer id="footer">
                <p>
                    Introduction to Robotics
                    <br/>
                    Electrical Engineering and Computer Sciences
                    <br/>
                    University of California, Berkeley
                </p>
            </footer>
        </div>

        <!-- Scripts -->
            <script src="assets/js/jquery.min.js"></script>
            <script src="assets/js/jquery.scrollex.min.js"></script>
            <script src="assets/js/jquery.scrolly.min.js"></script>
            <script src="assets/js/browser.min.js"></script>
            <script src="assets/js/breakpoints.min.js"></script>
            <script src="assets/js/util.js"></script>
            <script src="assets/js/main.js"></script>

    </body>
</html>
